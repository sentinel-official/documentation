"use strict";(self.webpackChunksentinel_docs=self.webpackChunksentinel_docs||[]).push([[9464],{85090:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>c,frontMatter:()=>i,metadata:()=>p,toc:()=>o});var n=a(87462),l=(a(67294),a(3905));const i={title:"SentinelHub - 2",sidebar_position:1},r="SentinelHub - 2",p={unversionedId:"upgrades/sentinelhub-2",id:"upgrades/sentinelhub-2",title:"SentinelHub - 2",description:"Hardfork upgrade from blockchain sentinelhub-1 to sentinelhub-2",source:"@site/docs/validator-setup/upgrades/sentinelhub-2.md",sourceDirName:"upgrades",slug:"/upgrades/sentinelhub-2",permalink:"/validator-setup/upgrades/sentinelhub-2",draft:!1,editUrl:"https://github.com/sentinel-official/docs/tree/main/docs/validator-setup/upgrades/sentinelhub-2.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"SentinelHub - 2",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Add a Validator Image",permalink:"/validator-setup/image"},next:{title:"Software upgrade - 1",permalink:"/validator-setup/upgrades/upgrade-1"}},s={},o=[{value:"Set halt block height",id:"set-halt-block-height",level:2},{value:"Export the state",id:"export-the-state",level:2},{value:"Install the new software",id:"install-the-new-software",level:2},{value:"Migrate the state",id:"migrate-the-state",level:2},{value:"Setup",id:"setup",level:2},{value:"Start",id:"start",level:2}],d={toc:o},m="wrapper";function c(e){let{components:t,...a}=e;return(0,l.kt)(m,(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"sentinelhub---2"},"SentinelHub - 2"),(0,l.kt)("p",null,"Hardfork upgrade from blockchain ",(0,l.kt)("inlineCode",{parentName:"p"},"sentinelhub-1")," to ",(0,l.kt)("inlineCode",{parentName:"p"},"sentinelhub-2")),(0,l.kt)("h2",{id:"set-halt-block-height"},"Set halt block height"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Open the file ",(0,l.kt)("inlineCode",{parentName:"p"},"${HOME}/.sentinelhubd/config/app.toml")," with a text editor")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Set the value ",(0,l.kt)("inlineCode",{parentName:"p"},"halt-height = 901800"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Save and close the file")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Restart the Sentinel Hub daemon")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Wait until the blockchain halt"))),(0,l.kt)("p",null,'???+ warning "Warning"'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"Follow the next steps only after the blockchain halt!\n")),(0,l.kt)("h2",{id:"export-the-state"},"Export the state"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Verify the software version"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"sentinelhubd version --long\n")),(0,l.kt)("p",{parentName:"li"},'???+ note "Note"'),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"Commit hash must be `1aed4ffff291f6cec7e3768806bebef4e9f4442c`\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Export the Blockchain state"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"HALT_HEIGHT=901800\n\nsentinelhubd export --height ${HALT_HEIGHT} > ${HOME}/${HALT_HEIGHT}.json\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Verify the SHA256 of the JSON file"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"jq -cSM '' ${HOME}/${HALT_HEIGHT}.json | sha256sum\n")),(0,l.kt)("p",{parentName:"li"},'???+ note "Note"'),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"Exported Genesis file hash must be `e519a0dbb7e7e177c72965c0f7cd8507a537548f56e696c44bd01360424137ad`\n")))),(0,l.kt)("h2",{id:"install-the-new-software"},"Install the new software"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Clone the source code"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"VERSION=v0.6.2\nBASE_DIRECTORY=${GOPATH}/src/github.com/sentinel-official\n\nrm -rf ${BASE_DIRECTORY}/hub/ && mkdir -p ${BASE_DIRECTORY} && cd ${BASE_DIRECTORY}/ && \\\ngit clone https://github.com/sentinel-official/hub.git && cd ${BASE_DIRECTORY}/hub/ && \\\ngit checkout ${VERSION}\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Build and install the software"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"make install\n")))),(0,l.kt)("h2",{id:"migrate-the-state"},"Migrate the state"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Verify the software version"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"sentinelhub version --long\n")),(0,l.kt)("p",{parentName:"li"},'???+ note "Note"'),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"Commit hash must be `4cd6b2bb3609b6ca86414d50216568e90b847c28`\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Migrate the exported Blockchain state"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"CHAIN_ID=sentinelhub-2\nGENESIS_TIME=2021-05-29T14:30:00Z\nINITIAL_HEIGHT=901801\n\nsentinelhub migrate \\\n    --chain-id=${CHAIN_ID} \\\n    --genesis-time=${GENESIS_TIME} \\\n    --initial-height=${INITIAL_HEIGHT} \\\n    ${HALT_HEIGHT}.json > ${HOME}/genesis.json\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Verify the SHA256 of the JSON file"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"jq -cSM '' ${HOME}/genesis.json | sha256sum\n")),(0,l.kt)("p",{parentName:"li"},'???+ note "Note"'),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"Migreated Genesis file hash must be `1dbcd7d58845b4b0696d31daafa2096bb3d729e51f8e8fa17e9e73eda1376382`\n")))),(0,l.kt)("h2",{id:"setup"},"Setup"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Initialize the chain configuration files"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"MONIKER=\n\nsentinelhub init ${MONIKER} \\\n    --chain-id ${CHAIN_ID}\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Copy validator node and consensus private keys"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"FROM_DIR=${HOME}/.sentinelhubd/config\nTO_DIR=${HOME}/.sentinelhub/config\n\ncp ${FROM_DIR}/node_key.json ${TO_DIR}/node_key.json\ncp ${FROM_DIR}/priv_validator_key.json ${TO_DIR}/priv_validator_key.json\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Copy migrated Genesis file"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"cp ${HOME}/genesis.json ${TO_DIR}/genesis.json\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Set minimun gas prices"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Open the file ",(0,l.kt)("inlineCode",{parentName:"li"},"${HOME}/.sentinelhub/config/app.toml")),(0,l.kt)("li",{parentName:"ul"},"Go to the line which contains the field ",(0,l.kt)("inlineCode",{parentName:"li"},'minimum-gas-prices = ""')),(0,l.kt)("li",{parentName:"ul"},"Change the value to ",(0,l.kt)("inlineCode",{parentName:"li"},'minimum-gas-prices = "0.1udvpn"')),(0,l.kt)("li",{parentName:"ul"},"Save the file"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Set peers and seeds"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Open the file ",(0,l.kt)("inlineCode",{parentName:"p"},"${HOME}/.sentinelhub/config/config.toml"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Go to the line which contains the field ",(0,l.kt)("inlineCode",{parentName:"p"},'persistent_peers = ""'))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Insert the below node addresses"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-text"},"05fe2a7847fd27345250915fd06752c424f40651@85.222.234.135:26656,387027e3b1180d3a619cbbf3462704a490785963@54.176.90.228:26656,63bd9cfce0f0d274aad5b166dd06d829021aec43@121.78.247.243:56656,855807cc6a919c22ec943050ebb5c80b23724ed0@3.239.11.246:26656,8caefbf8f4318ecc93f2c901cf11470e4a16c818@161.97.135.122:26656,9174af5f16f74660cccf49f893d243949af45f7f@54.177.29.46:26656,9fa528bd2b9e7c80724a1d8a4e1a2a8a83e7d123@142.93.72.221:26656,a77f6a094578dad899e2f40e0626b4c6d4705311@3.36.165.232:26656,bd45a11390d16d128a9eeea3935b53d7a1a3c120@15.236.127.69:26656,cdb8dd7628460a546ce1594ca0bc0c20366514cf@34.72.64.178:26656,d1efceccb04ded9a604e5235f76da86872157d68@161.97.149.223:26656,e00b23444cc8dbb353d5faa765ab36cfc0116b57@83.60.98.134:28685,e5ee89bd4fc371c6a0e66d2b8daefd891b6b87b5@157.90.117.58:26656,f7ceb735606f90df7eb6cd987641876955b6e325@46.4.55.150:36656\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Go to the line which contains the field ",(0,l.kt)("inlineCode",{parentName:"p"},'seeds = ""'))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Insert the below node addresses"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-text"},"c3aa0ff9b3eb17be1b0a26d7c8a5683e8e528e1a@159.89.192.105:26656\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Save the file"))))),(0,l.kt)("h2",{id:"start"},"Start"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Start the Sentinel Hub daemon")))}c.isMDXComponent=!0}}]);