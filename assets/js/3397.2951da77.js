"use strict";(self.webpackChunksentinel_docs=self.webpackChunksentinel_docs||[]).push([[3397],{93397:(e,t,i)=>{i.r(t),i.d(t,{dyte_livestream_indicator:()=>o,dyte_livestream_player:()=>d,dyte_viewer_count:()=>l});var a=i(22468),r=(i(33077),i(36685),i(46935)),s=i(55471),n=i(1723);i(1873),i(11792),i(74664);const o=class{constructor(e){(0,a.r)(this,e),this.setIsLivestreaming=e=>{this.isLivestreaming="LIVESTREAMING"===e},this.meeting=void 0,this.size=void 0,this.t=(0,n.u)(),this.isLivestreaming=void 0,this.iconPack=s.d}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e,t;null===(t=null===(e=this.meeting)||void 0===e?void 0:e.livestream)||void 0===t||t.removeListener("livestreamUpdate",this.setIsLivestreaming)}meetingChanged(e){var t,i;null!=e&&(this.setIsLivestreaming(null===(t=this.meeting.livestream)||void 0===t?void 0:t.state),null===(i=this.meeting.livestream)||void 0===i||i.on("livestreamUpdate",this.setIsLivestreaming))}render(){if((0,r.s)(this.meeting)&&this.isLivestreaming)return(0,a.h)(a.H,null,(0,a.h)("div",{class:"indicator","aria-label":this.t("livestream.indicator"),part:"indicator"},(0,a.h)("dyte-icon",{icon:this.iconPack.start_livestream,size:this.size}),(0,a.h)("span",null,this.t("LIVE"))))}static get watchers(){return{meeting:["meetingChanged"]}}};o.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);display:flex}:host[size='sm']{margin-left:var(--dyte-space-1, 4px);margin-right:var(--dyte-space-1, 4px)}.indicator{display:flex;flex-direction:row;align-items:center;font-size:14px;--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}dyte-icon{margin-right:var(--dyte-space-1, 4px);height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);animation:blink 4s linear infinite}:host([size='sm']) dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}:host([size='sm']) .indicator span{display:none}@keyframes blink{0%,10%{opacity:0}11%,100%{opacity:1}}";const d=class{constructor(e){(0,a.r)(this,e),this.dyteAPIError=(0,a.c)(this,"dyteAPIError",7),this.livestreamUpdateListener=e=>{this.livestreamState=e,this.playbackUrl=this.meeting.livestream.playbackUrl},this.getLoadingState=()=>{let e="",t=!1,i=!1;switch(this.livestreamState){case"IDLE":e=this.t("livestream.idle"),t=!0,i=!1;break;case"STARTING":e=this.t("livestream.starting"),t=!0,i=!0;break;case"STOPPING":e=this.t("livestream.stopping"),t=!0,i=!0;break;case"LIVESTREAMING":this.playerState!==r.P.PLAYING&&(e=this.t("livestream.starting"),i=!0,t=!0);break;default:t=!1,e=this.t(""),i=!0}return{isLoading:t,loadingMessage:e,showIcon:i}},this.getErrorState=()=>{var e,t;let i=!1,a="";return"LIVESTREAMING"!==this.livestreamState?(i=!1,a=this.t(""),{isError:i,errorMessage:a}):(this.isSupported||(i=!0,a=this.t("livestream.error.not_supported")),this.playbackUrl||(i=!0,a=this.t("livestream.error.not_found")),this.playerError&&(i=!0,a=this.t(null!==(t=null===(e=this.playerError)||void 0===e?void 0:e.message)&&void 0!==t?t:"livestream.error.unknown")),{isError:i,errorMessage:a})},this.startLivestreamPlayer=async()=>{try{this.meeting.__internals__.logger.info("dyte-livestream-player:: Initialising player element."),await window.__stream.initElement(this.player),this.meeting.__internals__.logger.info("dyte-livestream-player:: About to start player."),await window.dyte_hls.play(),this.playerState=r.P.PLAYING,this.audioPlaybackError=!1,this.meeting.__internals__.logger.info("dyte-livestream-player:: Player has started playing.")}catch(e){this.meeting.__internals__.logger.error("dyte-livestream-player:: Player couldn't start.",{error:e}),this.audioPlaybackError=!0}},this.loadLivestreamPlayer=async()=>{const e="https://cdn.dyte.in/streams/script.js";return!(!window.__stream&&this.isScriptWithSrcPresent(e))&&(!!window.__stream||new Promise((t=>{const i=document.createElement("script");i.src=e,i.onload=()=>{setTimeout((()=>{if(window.__stream)return this.meeting.__internals__.logger.info("dyte-livestream-player:: Finished script load. Added window._stream."),void t(!0);this.meeting.__internals__.logger.error("dyte-livestream-player:: onLoad didn't add window._stream in time."),t(!1)}),1e3)},i.onerror=e=>{this.meeting.__internals__.logger.error("dyte-livestream-player:: CDN script didn't load.",{error:e}),t(!1)},document.head.appendChild(i)})))},this.meeting=void 0,this.size=void 0,this.t=(0,n.u)(),this.iconPack=s.d,this.playbackUrl=void 0,this.isSupported=!0,this.playerState=r.P.IDLE,this.livestreamState="IDLE",this.playerError=void 0,this.latency=0,this.livestreamId=null,this.audioPlaybackError=!1}updateLivestreamId(){const e=this.meeting.livestream.playbackUrl;if(!e||"LIVESTREAMING"!==this.livestreamState)return this.livestreamId=null,this.player=null,void(window.dyteLivestreamPlayerElement=null);const t=e.split("/"),i=t.findIndex((e=>"manifest"===e)),a=t[i-1];this.livestreamId=a}isScriptWithSrcPresent(e){const t=document.querySelectorAll("script");for(let i of t)if(i.src===e)return!0;return!1}async connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.meeting.livestream.removeListener("livestreamUpdate",this.livestreamUpdateListener),this.player=null,window.dyteLivestreamPlayerElement=null}meetingChanged(e){null!=e&&(this.livestreamState=this.meeting.livestream.state,this.playbackUrl=this.meeting.livestream.playbackUrl,this.meeting.livestream.on("livestreamUpdate",this.livestreamUpdateListener))}render(){if(!(0,r.s)(this.meeting))return;const{isError:e,errorMessage:t}=this.getErrorState(),{isLoading:i,loadingMessage:s,showIcon:n}=this.getLoadingState();return(0,a.h)(a.H,null,(0,a.h)("div",{class:"player-container"},"LIVESTREAMING"===this.livestreamState&&this.livestreamId&&(0,a.h)("div",{class:"flex h-full w-full items-start justify-center pb-20"},(0,a.h)("stream",{width:"100%",height:"80vh",className:"overflow-hidden rounded-lg",src:this.livestreamId,ref:async e=>{this.player=e,window.dyteLivestreamPlayerElement=e;await this.loadLivestreamPlayer()&&await this.startLivestreamPlayer()},cmcd:!0,autoplay:!0,"force-flavor":"llhls","customer-domain-prefix":"customer-s8oj0c1n5ek8ah1e"})),this.audioPlaybackError&&(0,a.h)("div",{class:"unmute-popup"},(0,a.h)("h3",null,this.t("audio_playback.title")),(0,a.h)("p",null,this.t("audio_playback.description")),(0,a.h)("dyte-button",{kind:"wide",onClick:()=>{this.player&&(this.player.muted=!1),this.audioPlaybackError=!1},title:this.t("audio_playback"),iconPack:this.iconPack,t:this.t},this.t("audio_playback"))),e&&(0,a.h)("div",{class:"loader"},(0,a.h)("dyte-icon",{icon:this.iconPack.warning,t:this.t}),(0,a.h)("p",null,t)),!e&&i&&(0,a.h)("div",{class:"loader"},n&&(0,a.h)("dyte-spinner",{id:"icon",part:"spinner",iconPack:this.iconPack,t:this.t,size:"md"}),(0,a.h)("p",null,s))))}static get watchers(){return{livestreamState:["updateLivestreamId"],meeting:["meetingChanged"]}}};d.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);display:flex;height:100%;width:100%;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}.player-container{position:relative;margin:var(--dyte-space-4, 16px);display:flex;flex-grow:1;align-items:center;justify-content:center;overflow:hidden;border-radius:var(--dyte-border-radius-md, 8px)}.player{left:var(--dyte-space-0, 0px);z-index:20;aspect-ratio:16 / 9;height:100%;width:auto;border-radius:var(--dyte-border-radius-md, 8px);border-width:0px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity))}.loader{position:absolute;z-index:10;height:100%;width:100%;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));display:flex;flex-direction:column;align-items:center;justify-content:center}p{margin-top:var(--dyte-space-1, 4px);margin-bottom:var(--dyte-space-1, 4px);font-size:16px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.latency-controls{position:absolute;bottom:var(--dyte-space-4, 16px);right:var(--dyte-space-4, 16px);z-index:20;display:flex;flex-direction:row;align-items:center}.sync-live-stream{cursor:pointer;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px);font-size:12px}.unmute-popup{position:absolute;z-index:30 !important;display:flex;width:var(--dyte-space-72, 288px);flex-direction:column;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));padding:var(--dyte-space-4, 16px);text-align:center;max-width:70%}.unmute-popup h3{margin:var(--dyte-space-0, 0px);font-size:16px;font-weight:500}.unmute-popup p{margin-top:var(--dyte-space-3, 12px);margin-bottom:var(--dyte-space-3, 12px);font-size:14px}";const l=class{constructor(e){(0,a.r)(this,e),this.disconnectMeeting=e=>{var t;null!=e&&null!=this.countListener&&(null===(t=e.livestream)||void 0===t||t.removeListener("viewerCountUpdate",this.countListener))},this.meeting=void 0,this.variant="primary",this.iconPack=s.d,this.t=(0,n.u)(),this.viewerCount=0}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.disconnectMeeting(this.meeting)}meetingChanged(e,t){var i;this.disconnectMeeting(t),null!=e&&(this.countListener=()=>{var t;this.viewerCount=null===(t=e.livestream)||void 0===t?void 0:t.viewerCount},this.countListener(),null===(i=e.livestream)||void 0===i||i.addListener("viewerCountUpdate",this.countListener))}render(){return(0,r.s)(this.meeting)?(0,a.h)(a.H,{tabIndex:0,role:"log","aria-label":`${this.viewerCount} ${this.t("viewers")}`},(0,a.h)("dyte-icon",{icon:this.iconPack.viewers,tabIndex:-1,"aria-hidden":!0,part:"icon",iconPack:this.iconPack,t:this.t}),this.viewerCount," ",this.t("viewers")):null}static get watchers(){return{meeting:["meetingChanged"]}}};l.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);display:inline-flex;height:var(--dyte-space-10, 40px);-webkit-user-select:none;-moz-user-select:none;user-select:none;align-items:center;font-size:14px}:host([size='sm']){margin-left:var(--dyte-space-1, 4px);margin-right:var(--dyte-space-1, 4px);font-size:12px}dyte-icon{margin-right:var(--dyte-space-1, 4px);height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px)}:host([size='sm']) dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}:host([variant='embedded']){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));opacity:0.5;margin-top:var(--dyte-space-1, 4px);margin-left:var(--dyte-space-1, 4px);height:var(--dyte-space-5, 20px);border-radius:var(--dyte-border-radius-sm, 4px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);font-size:12px}:host([variant='embedded']) dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}"}}]);